<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Google fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Gemunu+Libre:wght@700&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <!-- Custom css -->
  <link rel="stylesheet" href="../static/mycss.css" />
  <!-- Jquery -->
  <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
    crossorigin="anonymous"></script>
  <!-- JQuery cookie -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"
    integrity="sha512-3j3VU6WC5rPQB4Ld1jnLV7Kd5xr+cq9avvhwqzbH/taCRNURoeEpoPBK9pDyeukwSxwRPJ8fDgvYXd6SkaZ2TA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <!-- Custom js -->
  <script src="../static/myjs.js"></script>
  <!-- Bulma -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css" />
  <!-- Bulma modal css -->
  <link rel="stylesheet" href="https://unpkg.com/bulma-modal-fx/dist/css/modal-fx.min.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <title>Comment</title>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar has-shadow" role="navigation">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <h1 class="Logo px-4">
          HELIOS
        </h1>
      </a>
      <a role="button" class="navbar-burger mt-2 mr-3" aria-label="menu" aria-expanded="false"
        data-target="navbar-div-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu" id="navbar-div-menu">
      <div class="navbar-start mx-4">
        <a class="navbar-item" href="/">
          Home
        </a>
        <a class="navbar-item" href="/about">
          About us
        </a>
        <a class="navbar-item" href="/blog">
          Blog
        </a>
      </div>
      <div class="navbar-end">
        <!-- search bar -->
        <div class="mx-5 my-5">
          <div class="search">
            <span class="search-icon material-symbols-outlined" onclick="search_images_redirect()">search</span>
            <input class="search-input" type="search" placeholder="Search" onkeydown="search_images_redirect()">
          </div>
        </div>
        <div class="mx-5 my-5">
          <figure class="profile-pic sidebar-listener" id="user-profile-picture">
            <img class="is-rounded" src="../static/defaults/48x48.png">
          </figure>
        </div>
      </div>
    </div>
  </nav>
  <div class="overlay sidebar-listener"></div>
  <div class="sidebar">
    <div class="mx-5 my-4">
      <figure class="profile-pic" id="sidebar-user-profile-picture">
        <img class="is-rounded" src="../static/defaults/48x48.png">
      </figure>
      <div class="has-text-white mt-4">
        <div id="sidebar-username">
          <p class="has-text-weight-bold">username</p>
        </div>
        <!-- Max 100 character -->
        <div class="mt-4">
          <p class="is-size-7 has-text-weight-light">About</p>
          <div>
            <p id="sidebar-user-about">...</p>
            <img width="17" height="17" src="../static/assets/edit-2.svg" alt="Edit icon">
          </div>
        </div>
        <!-- Max 30 character -->
        <div class="mt-4">
          <p class="is-size-7 has-text-weight-light">Gender</p>
          <div>
            <p id="sidebar-user-gender">N/A</p>
            <img width="17" height="17" src="../static/assets/edit-2.svg" alt="Edit icon">
          </div>
        </div>
        <hr class="separator">
        <div class="mt-4" onclick="window.location.href = '/bookmarks';">
          <span class="icon-text">
            <span class="icon">
              <i class="fa-solid fa-bookmark"></i>
            </span>
            <span>Bookmarks</span>
          </span>
        </div>
        <div class="mt-4">
          <span class="icon-text" onclick="window.location.href = '/my-gallery';">
            <span class="icon">
              <i class="fa-regular fa-images"></i>
            </span>
            <span>My Gallery</span>
          </span>
        </div>
        <div class="bottom-content" onclick="logout_account()">
          <span class="icon-text">
            <span class="icon">
              <i class="fa-solid fa-right-from-bracket"></i>
            </span>
            <span>Log Out</span>
          </span>
        </div>
      </div>
    </div>
  </div>
  <div class="container mb-5">
    <div class="columns is-centered mt-3">
      <div class="column is-half">
        <div class="box">
          <div class="card">
            <div class="card-image modal-button" style="overflow: hidden;" data-target="modal-image-{{ photo['_id']}}">
              <figure class="image is-4by3">
                <img src="{{ photo['image'] }}" alt="Photos by {{ photo['username'] }}" style="object-fit: cover;" />
              </figure>
            </div>
            <div class="card-content">
              <div class="media">
                <div class="media-left" style="overflow: hidden;">
                  <figure class="image is-48x48 is-1by1">
                    <img src="{{ poster_user['profile_pic'] }}" alt="Avatar {{ poster_user['username'] }}"
                      style="object-fit: cover;" />
                  </figure>
                </div>
                <div class="media-content">
                  <p class="title is-4">{{ photo['title'] }}</p>
                  <p class="subtitle is-6">@{{ poster_user['username'] }}</p>
                </div>
              </div>

              <div class="content">
                {{ photo['deskripsi'] }}

                {% for kategori in photo['kategori'].split(',') %}
                {% if kategori %}
                <a>#{{ kategori }} </a>
                {% endif %}
                {% endfor %}
                <br />
                <p class="is-size-6">{{ photo['date'] }}</p>
              </div>
              <div>
                {% if photo['like_by_me'] %}
                <span id="like-count-post" class="has-text-danger">{{ photo['count_like'] }}</span>
                {% else %}
                <span id="like-count-post" class="has-text-link">{{ photo['count_like'] }}</span>
                {% endif %}
                <span class="icon ml-4" id="heart-icon-modals-fullscreen-{{ photo['_id'] }}"
                  onclick="toggleLike('{{ photo['_id'] }}')">
                  {% if photo['like_by_me'] %}
                  <i class="fa-solid fa-heart has-text-danger"></i>
                  {% else %}
                  <i class="fa-regular fa-heart"></i>
                  {% endif %}
                </span>
                <span class="icon" id="bookmark-icon-modals-fullscreen-{{ photo['_id'] }}"
                  onclick="toggleBookmark('{{ photo['_id'] }}')">
                  {% if photo['bookmark_by_me'] %}
                  <i class="fa-solid fa-bookmark has-text-link"></i>
                  {% else %}
                  <i class="fa-regular fa-bookmark"></i>
                  {% endif %}
                </span>
                {% if is_superadmin or photo['username'] == current_username %}
                <span class="icon" id="delete-icon-modals-fullscreen-{{ photo['_id'] }}"
                  onclick="deleteImage('{{ photo['_id'] }}')">
                  <i class="fa-solid fa-trash"></i>
                </span>
                {% endif %}
              </div>
            </div>
          </div>
          <!-- TextArea -->
          <textarea class="textarea is-info" placeholder="Add Comment" id="input-text-area-comment"></textarea>
          <div id="hidden-comment-upload-progress" class="my-3">
            <button class="button is-info" onclick="uploadComment('{{ photo['_id']}}');">Kirim</button>
          </div>

        </div>
        <!-- komentar -->
        {% for comment in comments %}
        <div class="box">
          <article class="media">
            <div class="media-left" style="overflow: hidden;">
              <figure class="image is-64x64 is-1by1">
                <img src="{{ comment['profile_pic'] }}" alt="User profile pic" style="object-fit: cover;" />
              </figure>
            </div>
            <div class="media-content">
              <div class="content">
                <p>
                  <strong>@{{ comment['username'] }}</strong>
                  <br />
                  {% if is_superadmin or comment['username'] == current_username %}
                  <span class="icon" id="delete-icon-comment-{{ comment['_id'] }}"
                    onclick="deleteComment('{{ comment['_id'] }}')">
                    <i class="fa-solid fa-trash"></i>
                  </span>
                  {% endif %}
                  {{ comment['comment'] }}
                  <br />
                  <small>{{ comment['date'] }}</small>
                </p>
                <div class="user-comment">
                  <!-- Button untuk menyalin komentar -->
                  <button class="button is-small is-primary copy-button" onclick="copyComment(this)"
                    data-comment="{{ comment['comment'] }}">Salin Komentar</button>
                  <!-- Pesan pop-up untuk menunjukkan bahwa komentar telah disalin -->
                  <div class="copied-message" style="display: none;">Komentar telah disalin</div>
                </div>
              </div>
            </div>
          </article>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  <!-- Image modal-->
  <div id="modals-image-fullscreen">
    <div id="modal-image-{{ photo['_id'] }}" class="modal modal-fx-superScaled">
      <div class="modal-background">
        <div class="mx-4 column box bottom-content has-text-centered">
          <span class="icon" id="bookmark-icon-modals-fullscreen-{{ photo['_id'] }}"
            onclick="toggleBookmark('{{ photo['_id'] }}')">
            {% if photo['bookmark_by_me'] %}
            <i class="fa-solid fa-bookmark has-text-link"></i>
            {% else %}
            <i class="fa-regular fa-bookmark"></i>
            {% endif %}
          </span>
          <span class="icon ml-4" id="heart-icon-modals-fullscreen-{{ photo['_id'] }}"
            onclick="toggleLike('{{ photo['_id'] }}')">
            {% if photo['like_by_me'] %}
            <i class="fa-solid fa-heart has-text-danger"></i>
            {% else %}
            <i class="fa-regular fa-heart"></i>
            {% endif %}
          </span>
          <span class="icon ml-4" onclick="$('#input-text-area-comment').focus();">
            <i class="fa-solid fa-comment"></i>
          </span>
          {% if is_superadmin or photo['username'] == current_username %}
          <span class="icon ml-4" id="delete-icon-modals-fullscreen-{{ photo['_id'] }}"
            onclick="deleteImage('{{ photo['_id'] }}')">
            <i class="fa-solid fa-trash"></i>
          </span>
          {% endif %}
        </div>
      </div>
      <div class="modal-content is-image">
        <img loading="lazy" class="lazy-load" src="{{ photo['image'] }}" alt="Photos by {{ photo['username'] }}">
      </div>
      <button class="modal-close is-large" aria-label="close"></button>
    </div>
  </div>
  <!-- Bulma modal js -->
  <script src="../static/modal-fx.min.js"></script>
  <script>
    burger_function();
    $(document).ready(function () {
      const sidebar = $('#sidebar');
      const sidebarToggle = $('#sidebarToggle');

      sidebarToggle.click(function () {
        sidebar.toggleClass('is-active');
      });
      render_users_infos();
      sidebar_listener();
      // file_upload_image_namer();
    });
  </script>
</body>

</html>